# 1 文件系统的层次结构

## 路径名

凡是以根目录为起始位置，即以斜线字符/为起始字符的路径名称为绝对路径名。

凡以当前工作目录或其他以非斜线字符为起始字符的所有路径名都是相对路径名

此外，每个目录中均包含以句点.和双句点..命名的两个特殊目录文件，分别表示当前目录及其父目录。其中句点.是当前目录的别名，凡是期望访问当前目录中的文件时，都可以直接使用句点.而不必明确给出当前目录名

# 2 文件系统的组织结构

![1640089280764](https://raw.githubusercontent.com/liang636600/cloudImg/master/images/1640089280764.jpg)

## linux系统的部分主要目录

/bin 其中包含系统，系统管理员和普通用户可以共享的各种通用程序，如cat，cp，mv，rm，ls，ps等常用的基本命令，以及各种shell如bash等

/boot 

/dev 在linux系统中，任何设备均对应一个或多个特殊文件（也称设备文件），这个目录包含系统支持的所有设备文件。mem表示物理内存，sda表示连接到主控制器的第一个磁盘，sda1和sda2则分别表示其中的第一和第二个磁盘分区

/etc 其中包含所有系统管理和维护方面的配置文件

​	ssh目录：OpenSSH网络服务所用配置和控制文件的根目录

/home 

/lib 含有系统引导过程，以及运行系统命令所需要的内核模块和各种动态链接共享库文件

/lost+found 

/mnt 文件系统的临时安装点，可以临时安装任何文件系统或远程资源。也可以在此目录中创建若干子目录，以便安装不同的设备，如使用/mnt/cdrom和/mnt/usb分别安装CD/DVD和U盘等

/opt 应用程序等附加软件的安装目录

/proc 进程文件系统proc的根目录，其中部分文件分别对应当前正在运行的进程，可用于访问当前进程的地址空间。可以把/proc看做系统内核的一个控制和信息中心

/root 超级用户root的主目录

/sbin 其中包含与系统引导管理和维护，以及与硬件配置等方面的有关命令或脚本文件，如fdisk，init和ifconfig等。注意，/sbin目录中的命令主要供超级用户使用，普通用户通常无法使用

/sys 系统各种设备配置信息的根目录。例如block子目录中含有磁盘及磁盘分区的配置信息

/tmp 临时文件目录。

/usr 存有系统提供的各种共享数据（如用户命令，库函数，头文件和文档等）

​	bin 其中包含用户经常使用的各种命令

​	include 用于存储各种c语言头文件

​	lib 其中包含各种共享的库函数

​	sbin 其中包含系统引导完成之后系统管理员经常使用的各种系统管理和维护命令

​	share 共享目录

​	src 用于存放linux系统内核的源代码，头文件，Makefile和文档等

/var 用于存储各种可变长的数据文件（如日志文件），暂存文件或待处理的临时文件等

# 3 文件的类型

## 特殊文件

也称设备文件。为了便于用户访问外部设备而不必涉及各种I/O设备的具体操作细节，linux系统利用特殊文件作为用户与I/O设备间的接口，使用户能像读写普通文件一样访问外部设备。

特殊文件不包含任何数据，只是提供一种机制，在文件系统中建立一个物理设备与文件名之间的映射。系统支持的每个设备，包括内存，都与至少一个特殊文件相关联

## 链接文件

只需在文件系统中保存一份程序或副本，多个文件名均指向同一数据内容，更新任何一个文件，即可反映到其他文件中。

信息节点与数据是一一对应的。如果文件的信息节点号相同，其引用的就是同一个信息节点，因而拥有同一数据副本

可以使用ln命令创建硬链接文件

只能在同一个物理文件系统中使用

## 符号链接文件

能够跨越不同的物理文件系统建立链接文件，可以使用`ln -s`实现

符号链接文件的本身也是一种数据文件，而且是一个单独的文件，只不过文件中的内容并非真正的数据，而是一个指向目的文件（或目录）的路径名而已。

当引用符号链接文件时，系统首先需要打开符号链接文件本身，然后再根据文件中的内容，打开其指向的文件。符号链接文件可用于引用任何文件，尤其是目录，但硬链接不能链接目录。

![1640157982001](https://raw.githubusercontent.com/liang636600/cloudImg/master/images/1640157982001.jpg)

## 管道文件

# 4 文件的安全保护机制

linux从文件出发，把用户分为三类：文件属主，同组用户和其他用户。对于任何一个文件，可以针对三类用户分别赋予一定的访问权限。这些权限分为读，写和执行

| 访问权限  | 简单说明                                                     |
| --------- | ------------------------------------------------------------ |
| r         | 如显示文件内容，复制文件等。如果允许用户进入某个目录（cd），列举目录下的文件，至少应赋予用户读目录的访问权限 |
| w         | 除了读权限还可以修改，移动和删除文件等。对于目录而言，如果允许用户创建新文件和删除文件，必须赋予用户写目录的权限 |
| x（执行） | 相应的用户可以运行文件。对于目录而言，如果允许用户访问其中的任何子目录，必须赋予用户执行目录的权限 |

## 4.1 显示文件的访问权限

例如，命令`ls -l /`

drwxr-x--- 该权限分为4个部分d、rwx、r-x、---。

d:表示文件类型；rwx：表示文件所有者的对该文件所拥有的权限；r-x：表示文件所属组对该文件所拥有的权限；---：表示其他用户对该文件所拥有的权限。

下面表格详细的表述了各个部分意义

读(read)，写(write)，执行r(recute)简写即为(r,w,x),亦可用数字来(4,2,1)表示

![img](https://raw.githubusercontent.com/liang636600/cloudImg/master/images/20190515155004267.jpg)

**第一个减号“-”代表的是文件类型：**

**-：普通文件，d:目录文件，l:链接文件，b:设备文件，c:字符设备文件，p:管道文件**

![img](https://raw.githubusercontent.com/liang636600/cloudImg/master/images/20190515154912360.jpg)

## 4.2 修改文件的访问权限

可以使用chmod命令。修改文件或目录访问权限的前提是，用户必须是文件或目录的属主，或者是超级用户。chmod语法格式如下：

`chmod permissions dir-or-file`

其中permissions表示新的访问权限，相对权限设置法

（1）使用一个或多个字符表示用户的类型

* u（表示文件属主）
* g（表示同组用户）
* o（表示其他用户）
* a（表示所有用户）

（2）使用+-分别表示增加和撤销相应的访问权限

（3）使用一个或多个字符表示实际的访问权限

* r
* w
* x

例如，命令`chmod o+w script`表示增加其他用户写script的权限。命令`chmod o-rx script`撤销其他用户读和执行同一文件的访问权限。命令`chmod a+x settcp`表示所有用户都能执行settcp。命令`chmod go-w *`设置当前目录中所有文件的访问权限，只有文件属主能写

## 4.3 设置文件的访问权限

绝对权限设置法，命令

`chmod numcode dir-or-file`

numcode是一个数字代码，用于表示文件的访问权限，由三位数字组成，分别对应文件属主，同组用户和其他用户

如果某文件权限为7（rwx111）则代表可读，可写，可执行

若权限为6(110)则代表可读，可写。

权限为5(101)代表可读和可执行.

权限为3(011)代表可写(2)和可执行(1)。

例如`chmod 755 setftp`，表示属主可读可写可执行，同组用户和其他用户可读可执行

## 4.4 其他访问权限设置

1. 默认访问权限

   系统默认的目录访问权限为777，文件访问权限为666.如果设置了用户掩码，目录和文件的实际访问权限是由系统访问权限和用户掩码经过逻辑异或后的结果。

   用户掩码通常包含三组八进制数字，其取值范围为0~7：

   * 第一组数字用于设置用户自己的访问权限
   * 第二组数字用于设置同组用户的访问权限
   * 第三组数字用于设置其他用户的访问权限

   在ubuntu20中，系统设置的用户掩码为002，经过逻辑异或运算之后，可知新建目录的访问权限为775，新建文件的访问权限为664

   查看用户的权限掩码`umask`

   ```
   $ umask
   0002
   $ umask -S
   u=rwx,g=rwx,o=rx
   ```
   
   ```
   -rw-rw-r-- 1 dyp930 dyp930    0 Jun 28 06:02 a.txt //权限为664
   drwxrwxr-x 2 dyp930 dyp930 4096 Jun 28 06:02 a     //权限为775
   ```
   
   修改用户的权限掩码`umask abc`例如`umask 000`，这样新建文件的默认权限是`-rw-rw-rw-`，新建文件夹的默认权限是`drwxrwxrwx`
